(function(){var e=function(d,a){return function(){return d.apply(a,arguments)}},f={}.hasOwnProperty,g=function(d,a){function c(){this.constructor=d}for(var b in a)f.call(a,b)&&(d[b]=a[b]);c.prototype=a.prototype;d.prototype=new c;d.__super__=a.prototype;return d};Backbone.GoogleChart=function(d){function a(){this._listers=e(this._listers,this);this._removeGoogleListener=e(this._removeGoogleListener,this);this._addGoogleListener=e(this._addGoogleListener,this);this.unbind=e(this.unbind,this);this.bind=
e(this.bind,this);this.render=e(this.render,this);this.id=e(this.id,this);this.onGoogleLoad=e(this.onGoogleLoad,this);return a.__super__.constructor.apply(this,arguments)}g(a,d);a.prototype.initialize=function(a){var b;b=_.extend({},a);_(["el","id","attributes","className","tagName"]).map(function(a){return delete b[a]});google.load("visualization","1",{packages:["corechart"],callback:function(a){return function(){return a.onGoogleLoad("loaded")}}(this)});return this.onGoogleLoad(function(a){return function(){var c,
d;a.google=google.visualization;b.dataTable instanceof Array&&(b.dataTable=a.google.arrayToDataTable(b.dataTable));"function"===typeof b.beforeDraw&&b.beforeDraw(a,b);(c=b.formatter)&&_(function(){d=[];for(var a=0,c=b.dataTable.getNumberOfRows()-1;0<=c?a<=c:a>=c;0<=c?a++:a--)d.push(a);return d}.apply(this)).map(function(a){return _(c.columns).map(function(d){return b.dataTable.setFormattedValue(a,d,c.callback(b.dataTable.getValue(a,d)))})});return a.wrapper=new a.google.ChartWrapper(b)}}(this))};
a.prototype.onGoogleLoad=function(a){return"loaded"===a?(this.googleLoaded=!0,_(this.onGoogleLoadItems).map(function(a){return a()})):this.googleLoaded?a():(this.onGoogleLoadItems||(this.onGoogleLoadItems=[])).push(a)};a.watch=function(c,b){var d,e;(a._list||(a._list={}))[c]=b;if(!a._watching)return a._watching=!0,e=10,(d=function(){_(a._list).map(function(c,b){if($(b)[0])return c()&delete a._list[b]});return _(a._list).isEmpty()?a._watching=!1:setTimeout(d,e+=10)})()};a.prototype.id=function(){var a;
return(null!=(a=this.el)?a.id:void 0)||this.randomID()};a.prototype.render=function(){this.onGoogleLoad(function(a){return function(){return a.constructor.watch("#"+a.el.id,function(){return a.wrapper.draw(a.el.id)})}}(this));return this};a.prototype.bind=function(c,b){var d;(d=this._listers())[c]||(d[c]=this._addGoogleListener(c));return a.__super__.bind.call(this,c,b)};a.prototype.on=a.prototype.bind;a.prototype.unbind=function(c,b,d){c?this._removeGoogleListener(c):b?_(_(this._listers()).pairs()).map(function(a){return function(c){if(c[1]===
b)return a._removeGoogleListener(c[0])}}(this)):_(_(this._listers()).values()).map(this._removeGoogleListener);return a.__super__.unbind.call(this,c,b,d)};a.prototype.off=a.prototype.unbind;a.prototype._addGoogleListener=function(a){return this.onGoogleLoad(function(b){return function(){return b.google.events.addListener(b.wrapper,a,function(){return b.trigger(a,b.wrapper.getChart())})}}(this))};a.prototype._removeGoogleListener=function(a){return this.onGoogleLoad(function(b){return function(){b.google.events.removeListener(b._listers()[a]);
return delete b._listers()[a]}}(this))};a.prototype._listers=function(){return this._listersObj||(this._listersObj={})};a.prototype.randomID=function(){return _.uniqueId("gc_")};return a}(Backbone.View)}).call(this);